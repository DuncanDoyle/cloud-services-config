{
    "uuid": "74d1c20c-a753-4eb4-a487-96338ad940a2",
    "name": "advanced",
    "options": {
        "xml": "<assign:variable>\n    <name>CC_CHECK</name>\n    <value>on</value>\n</assign:variable>\n<match:request.method value=\"AKAMAI_PURGE AKAMAI_TRANSLATE\">\n    <assign:variable>\n        <name>CC_CHECK</name>\n        <value>off</value>\n    </assign:variable>\n</match:request.method>\n<match:client.ip2 value=\"127.0.0.1\" check-ips=\"connecting\">\n    <assign:variable>\n        <name>CC_CHECK</name>\n        <value>off</value>\n    </assign:variable>\n</match:client.ip2>\n<match:variable name=\"CC_CHECK\" value=\"on\">\n    <match:request.type value=\"CLIENT_REQ\">\n        <assign:extract-value>\n            <location>Client_Certificate</location>\n            <location-id>status_msg</location-id>\n            <variable-name>CC_STATUS_MSG</variable-name>\n        </assign:extract-value>\n        <match:variable name=\"CC_STATUS_MSG\" value=\"missing\" result=\"false\">\n            <assign:extract-value>\n                <location>Client_Certificate</location>\n                <location-id>issuer_dn</location-id>\n                <variable-name>CC_ISSUER</variable-name>\n            </assign:extract-value>\n            <edgeservices:modify-outgoing-request.add-header>\n                <name>x-rh-certauth-issuer</name>\n                <status>on</status>\n                <value>%(CC_ISSUER)</value>\n            </edgeservices:modify-outgoing-request.add-header>\n            <assign:extract-value>\n                <location>Client_Certificate</location>\n                <location-id>subject_dn</location-id>\n                <variable-name>CC_CN</variable-name>\n            </assign:extract-value>\n            <edgeservices:modify-outgoing-request.add-header>\n                <name>x-rh-certauth-cn</name>\n                <status>on</status>\n                <value>%(CC_CN)</value>\n            </edgeservices:modify-outgoing-request.add-header>\n            <edgeservices:modify-outgoing-request.add-header>\n                <name>x-rh-certauth-host</name>\n                <status>on</status>\n                <value>cloud.redhat.com</value>\n            </edgeservices:modify-outgoing-request.add-header>\n        </match:variable>\n    </match:request.type>\n</match:variable>",
        "description": "Client Certificate Logic"
    }
}